include mixins/bytes

mixin instance_detail()
  - build = instance.build
  - host = instance.host
  .col-md-6
    .panel.panel-default
      .panel-heading: h3.panel-title Instance Details
      .panel-body
        dl.dl-horizontal
          dt MongoDB
          dd #{build.version}
          dt Operating System
          dd #{host.os}
          dt RAM
          dd: +bytes(host.memory_bits)
          dt Architecture
          dd #{host.cpu_bits}bit
          dt Cores
          dd #{host.cpu_cores_physical}
          dt Details
          dd #{host.cpu_string}
          dt System Clock
          dd #{host.system_time}

if deployment.type === 'standalone'
  //- ol.breadcrumb
  //-   li.active #{instance.id}

  h1.page-header #{instance.id}
  .row
    .col-md-6
      .panel.panel-default
        .panel-heading: h3.panel-title Databases
        .panel-body
          ul.list-group
            each db in instance.database_names
              li.list-group-item
                span.badge -
                a(href="#database/#{db}") #{db}
    +instance_detail()
  .row
    .col-md-3
      .panel.panel-default
        .panel-heading: h3.panel-title Index Hits
        .panel-body
          h4 #{(metrics.indexes.hits_count/metrics.indexes.accesses_count * 100).toFixed(0)}%
    .col-md-3
      .panel.panel-default
        .panel-heading: h3.panel-title Index Misses
        .panel-body
          h4 #{(metrics.indexes.misses_count/metrics.indexes.accesses_count * 100).toFixed(0)}%
    .col-md-3
      .panel.panel-default
        .panel-heading: h3.panel-title Connections
        .panel-body
          h4 #{metrics.network.connections_count}
    .col-md-3
      .panel.panel-default
        .panel-heading: h3.panel-title Connections
        .panel-body
          h4 #{metrics.network.connections_count}
  .row
    .col-md-12
      .panel.panel-default
        .panel-heading: h3.panel-title Log
        .panel-body

else
  h1 #{instance.id}
  h2 #{deployment.id}
  h3 #{deployment.type}

  +instance_detail()
