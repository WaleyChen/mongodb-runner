include mixins/cog
include mixins/bytes

mixin health_bar(build)
  ul.list-inline
    li(class="label #{instance.host.cpu_bits === 64 ? 'label-success' : 'label-warning'}") #{instance.host.cpu_bits}bit
    li(class="label #{build.debug === false ? 'label-success' : 'label-warning'}")
      | debug #{build.debug ? 'on' : 'off'}
    li(class="label #{build.javascript_engine === 'V8' ? 'label-success' : 'label-warning'}")
      | #{build.javascript_engine}
    li(class="label #{build.allocator === 'tcmalloc' ? 'label-success' : 'label-warning'}")
      | #{build.allocator}
    li.label.label-success boost #{build.boost_version}

    li(class="label #{build.openssl_version ? 'label-success' : 'label-warning'}")
      | openssl #{build.openssl_version || 'N/A'}

if instance.database_names.length === 0
.row
  .col-md-6.col-md-push-3
    .panel.panel-default
      .panel-body.well
        :markdown
          #### Welcome to mongoscope!

          It appears you don't have any databases on this instance.

          To get started, open a new terminal window and copy and paste:

          ```
          mongo --eval \
          "db.rating.save( \
            {_id:'mongoscope', votes:[{you: 100}]})"
          ```

      img.leafy(src="img/leafy-anim.gif", style="height: 70px; float: right;")
      div(style="float: right; margin-top: 25px; text-align: right;")
        | create a database to continue.
        br
        | the leaf has it under control while you do.

else
.row
  .col-md-8
    .list-group
     - for database_name in instance.database_names
      a.list-group-item(href='#database/#{database_name}', style="margin: 0; padding: 0;")
        h2.list-group-item-heading #{database_name}
        ul.list-inline(style="border-top: 1px solid rgba(128, 127, 127, 0.2); font-variant: small-caps;margin: 0;")
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 8 colls
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 27 index
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 120 gigab
      a.list-group-item(href='#database/#{database_name}', style="margin: 0; padding: 0;")
        h2.list-group-item-heading #{database_name}2
        ul.list-inline(style="border-top: 1px solid rgba(128, 127, 127, 0.2); font-variant: small-caps;margin: 0;")
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 8 colls
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 2 index
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 1 gigab
      a.list-group-item(href='#database/#{database_name}', style="margin: 0; padding: 0;")
        h2.list-group-item-heading #{database_name}3
        ul.list-inline(style="border-top: 1px solid rgba(128, 127, 127, 0.2); font-variant: small-caps;margin: 0;")
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 8 colls
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 2 index
          li(style="color: rgba(128, 127, 127, 1.0);border-right:  1px solid rgba(128, 127, 127, 0.2);") 1 gigab

  .col-md-4
    h3(style="font-size: 12px; font-weight: normal; color: lightgray;font-variant: small-caps;")
      a(style="font-size: 200%;" href=instance.build.commit_url, title="View commit #{instance.build.commit.substr(0, 8)} on github") #{instance.build.version}
    +health_bar(instance.build)

    ul.list-inline
      li.label.label-default #{instance.host.os}
      li.label.label-default
        +bytes(instance.host.memory_bits)
      li.label.label-default #{instance.host.cpu_cores_physical} Cores

    ul.list-inline(style="margin: 0")
      li.label.label-default(style="font-weight: normal;font-size: 12px !important;") #{instance.host.cpu_string}
    ul.list-inline(style="margin: 0;")
      li.label.label-default(style="font-weight: normal;font-size: 12px !important;") #{instance.host.system_time}
        span.glyphicon.glyphicon-time(style="font-size: 80%; left: 4px;")
    ul.list-inline(style="margin: 0;")
      li.label.label-default(style="font-weight: normal;font-size: 12px !important;") #{instance.host.hostname}
